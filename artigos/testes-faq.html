<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Marco Tulio Valente" />
  <title>Perguntas Frequentes sobre Testes de Software ‚Äì Engenharia de Software Moderna</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    q { quotes: "‚Äú" "‚Äù" "‚Äò" "‚Äô"; }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-8249107-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-8249107-3', {'anonymize_ip': true});
  </script>

  <script>
  var trackOutboundLink = function(url, action, category) {
      gtag('event', action, {
        'event_category': category,
        'event_label': url,
        'transport_type': 'beacon',
        'event_callback': function(){document.location = url;}
      });
  }
  </script>

  <link rel="shortcut icon" type="image/x-icon" href="https://engsoftmoderna.info/figs/favicon.ico">

  <!--
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css">
  --->

  <link rel="stylesheet" href="https://engsoftmoderna.info/helper/mini-default.min.css">

  <style>
  body {
    background-color: #FFFFFF;
    foreground-color: black;
  }
  .anchor-link {
    opacity: 0.17;
    font-size: 70%;
  }
  </style>
</head>
<body>
<div class="container">
<div class="row cols-sm-12 col-md-8 col-lg-6">
<div class="col-md-offset-1 col-lg-offset-3">

<p>
<a href="https://engsoftmoderna.info"><img src="https://engsoftmoderna.info/figs/capa/foto-capitulos-html.jpg"></a>
</p>

<p>
<a href="https://engsoftmoderna.info">P√°gina principal do livro</a>
</p>

<p>Compre na

<a href="https://www.amazon.com.br/gp/product/6500019504"
      onclick="trackOutboundLink('https://www.amazon.com.br/gp/product/6500019504', 'amazon-caps', 'amazon-caps'); return false;">
      Amazon</a>, 

<a href="https://www.submarino.com.br/produto/1768283036/engenharia-de-software-moderna"
      onclick="trackOutboundLink('https://www.submarino.com.br/produto/1768283036/engenharia-de-software-moderna', 'submarino-caps', 'submarino-caps'); return false;">
      Submarino</a> ou 

<a href="https://produto.mercadolivre.com.br/MLB-1552071489-engenharia-de-software-moderna-_JM"
      onclick="trackOutboundLink('https://produto.mercadolivre.com.br/MLB-1552071489-engenharia-de-software-moderna-_JM', 'mercadolivre-caps', 'mercadolivre-caps'); return false;">
      MercadoLivre</a>.
</p>

<!---

<p>
<a href="https://twitter.com/engsoftmoderna?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-lang="pt" data-show-count="true">Follow @engsoftmoderna</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</p>


<p> <b> Novidade:</b> Estamos tamb√©m no 
<a href="https://twitter.com/engsoftmoderna"
  onclick="trackOutboundLink('https://twitter.com/engsoftmoderna', 'twitter', 'twitter'); return false;">
  Twitter</a>.
</p>

--->
<header id="title-block-header">
<h1 class="title">Engenharia de Software Moderna</h1>
<p class="author">Marco Tulio Valente</p>
</header>
<h1 class="unnumbered" id="perguntas-frequentes-sobre-testes">Perguntas Frequentes sobre Testes <a href="#perguntas-frequentes-sobre-testes" class="anchor-link" aria-hidden="true">üîó</a></h1>
<p>O objetivo deste artigo √© responder algumas perguntas frequentes que s√£o feitas sobre o <a href="../cap8.html">Cap√≠tulo 8</a> do livro. No entanto, estamos interessados apenas em perguntas conceituais, principalmente sobre os tr√™s tipos de testes abordados no cap√≠tulo: <strong>unidade, integra√ß√£o e sistema</strong>. Tamb√©m, n√£o pretendemos abordar quest√µes espec√≠ficas de um framework de testes ou de qualquer outra tecnologia.</p>
<p>Segue a lista atual de perguntas:</p>
<ol type="1">
<li><a href="#o-certo-%C3%A9-teste-de-unidade-ou-teste-unit%C3%A1rio">O certo √© teste de unidade ou teste unit√°rio?</a></li>
<li><a href="#o-que-%C3%A9-uma-unidade">O que √© uma unidade?</a></li>
<li><a href="#no-contexto-de-testes-o-que-significam-os-termos-falso-positivonegativo-e-verdadeiro-positivonegativo">No contexto de testes, o que significam os termos falso positivo/negativo e verdadeiro positivo/negativo?</a></li>
<li><a href="#precisamos-testar-m%C3%A9todos-privados">Precisamos testar m√©todos privados?</a></li>
<li><a href="#como-testar-m%C3%A9todos-que-t%C3%AAm-efeito-colateral">Como testar m√©todos que t√™m efeito colateral?</a></li>
<li><a href="#como-testar-m%C3%A9todos-que-n%C3%A3o-t%C3%AAm-efeito-colateral">Como testar m√©todos que n√£o t√™m efeito colateral?</a></li>
<li><a href="#quando-preciso-criar-um-mock-para-uma-depend%C3%AAncia">Quando preciso criar um mock para uma depend√™ncia?</a></li>
<li><a href="#como-criar-um-mock-para-uma-depend%C3%AAncia-privada">Como criar um mock para uma depend√™ncia privada?</a></li>
<li><a href="#por-que-n%C3%A3o-usam-o-termo-dubl%C3%AA-de-testes-no-livro">Por que n√£o usam o termo dubl√™ de testes no livro?</a></li>
<li><a href="#em-qual-pacote-ou-m%C3%B3dulo-ou-diret%C3%B3rio-devo-colocar-os-testes">Em qual pacote (ou m√≥dulo, ou diret√≥rio) devo colocar os testes?</a></li>
<li><a href="#o-que-%C3%A9-um-teste-de-fuma%C3%A7a-smoke-test">O que √© um teste de fuma√ßa (smoke test)?</a></li>
</ol>
<h3 class="unnumbered" id="o-certo-√©-teste-de-unidade-ou-teste-unit√°rio">1. O certo √© teste de unidade ou teste unit√°rio? <a href="#o-certo-√©-teste-de-unidade-ou-teste-unit√°rio" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Os dois termos s√£o usados. Ent√£o, assumindo que a l√≠ngua √© uma entidade viva e din√¢mica, n√£o consideramos errado usar qualquer um deles. Dito isso, preferimos teste de unidade, porque teste unit√°rio pode passar a ideia errada de que temos um √∫nico teste no sistema.</p>
<h3 class="unnumbered" id="o-que-√©-uma-unidade">2. O que √© uma unidade? <a href="#o-que-√©-uma-unidade" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>No contexto de testes de unidade, a defini√ß√£o de unidade n√£o √© totalmente objetiva. Tendemos a dizer que uma unidade √© uma classe, no caso de sistemas orientados a objetos. No entanto, n√£o precisamos ser dogm√°ticos e podemos considerar que certos testes v√£o testar um <strong>conjunto de classes</strong>. O fundamental √© que tais testes atendam aos princ√≠pios FIRST, principalmente aqueles associados √†s tr√™s primeiras letras: r√°pidos, independentes e repet√≠veis (ou determin√≠sticos). Mais detalhes sobre esses princ√≠pios na Se√ß√£o 8.3.1 do <a href="../cap8.html#princ%C3%ADpios-first">Cap√≠tulo 8</a>.</p>
<h3 class="unnumbered" id="no-contexto-de-testes-o-que-significam-os-termos-falso-positivonegativo-e-verdadeiro-positivonegativo">3. No contexto de testes, o que significam os termos falso positivo/negativo e verdadeiro positivo/negativo? <a href="#no-contexto-de-testes-o-que-significam-os-termos-falso-positivonegativo-e-verdadeiro-positivonegativo" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Seguem as defini√ß√µes:</p>
<ul>
<li>Falso positivo: um teste que falha, embora o c√≥digo testado esteja correto.</li>
<li>Falso negativo: um teste que passa, apesar de o c√≥digo testado ter um bug.</li>
<li>Verdadeiro positivo: um teste que falha e o c√≥digo testado, de fato, tem um bug.</li>
<li>Verdadeiro negativo: um teste que passa e o c√≥digo testado, de fato, est√° correto.</li>
</ul>
<p>Ou seja, com testes, sempre almejamos obter verdadeiro positivos ou negativos. Um falso positivo indica um bug nos nossos testes. Por fim, um falso negativo indica que deixamos de testar entradas que levariam o programa a falhar.</p>
<p>Ainda para ficar mais claro:</p>
<ul>
<li>verdadeiro = teste cujo resultado √© confi√°vel</li>
<li>falso = teste cujo resultado n√£o √© confi√°vel</li>
<li>positivo = teste que falha, isto √©, emite um <q>alerta</q></li>
<li>negativo = teste que passa</li>
</ul>
<h3 class="unnumbered" id="precisamos-testar-m√©todos-privados">4. Precisamos testar m√©todos privados? <a href="#precisamos-testar-m√©todos-privados" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>N√£o, pois eles v√£o ser testados quando testarmos os m√©todos p√∫blicos da classe. Em outras palavras, o foco deve ser testar os m√©todos p√∫blicos. Por tabela, isso vai garantir que os m√©todos privados tamb√©m est√£o funcionando.</p>
<h3 class="unnumbered" id="como-testar-m√©todos-que-t√™m-efeito-colateral">5. Como testar m√©todos que t√™m efeito colateral? <a href="#como-testar-m√©todos-que-t√™m-efeito-colateral" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Primeiro, uma r√°pida defini√ß√£o de efeito colateral: o termo designa m√©todos cuja execu√ß√£o n√£o apenas retorna um valor, mas tamb√©m altera o contexto de execu√ß√£o. Por exemplo, um m√©todo tem um efeito colateral quando ele altera o valor de um atributo do seu objeto ou de uma vari√°vel global, salva um valor em algum arquivo, envia um mail, etc.</p>
<p>Voltando √† pergunta, temos duas poss√≠veis respostas:</p>
<ul>
<li>Testar se o efeito colateral ocorreu</li>
<li>Implementar um teste comportamental ou de intera√ß√£o</li>
</ul>
<p>Vamos explicar cada um desses casos a seguir.</p>
<h5 class="unnumbered" id="teste-do-efeito-colateral">Teste do efeito colateral <a href="#teste-do-efeito-colateral" class="anchor-link" aria-hidden="true">üîó</a></h5>
<p>Suponha um m√©todo <code>push()</code> que altera o estado da sua pilha, para incluir mais um item. Nesse caso, podemos usar um outro m√©todo, do pr√≥prio objeto, para testar se o efeito colateral desejado ocorreu. Por exemplo, um m√©todo <code>size()</code>, que retorna o tamanho da pilha, pode ajudar. Veja um exemplo:</p>
<pre><code>void testeEmpilhaStack() {
  Stack stack = new Stack();
  stack.push(10);
  stack.push(20);
  stack.push(30);
  int size = stack.size();
  assertEquals(3,size);
}</code></pre>
<p>Veja que o m√©todo <code>push</code> retorna <code>void</code>. Ou seja, realmente, n√£o conseguimos testar um <code>push</code> de forma usual: isto √©, chamando-o e verificando se o valor que ele retorna √© aquele esperado.</p>
<h5 class="unnumbered" id="teste-comportamental-ou-de-intera√ß√£o">Teste comportamental (ou de intera√ß√£o) <a href="#teste-comportamental-ou-de-intera√ß√£o" class="anchor-link" aria-hidden="true">üîó</a></h5>
<p>Suponha agora que um m√©todo envia um mail, que chega na caixa postal de um outro processo. Normalmente, n√£o √© f√°cil contactar esse processo para testar se a mensagem, de fato, chegou. Uma poss√≠vel solu√ß√£o consiste em usar um mock e realizar um tipo de teste chamado de <strong>teste comportamental</strong> ou <strong>teste de intera√ß√£o</strong>. Isto √©, testamos se a execu√ß√£o do m√©todo sob teste chamou algum m√©todo de interesse. No nosso caso, devemos testar se essa execu√ß√£o chamou o m√©todo que produz o efeito colateral que nos interessa (o envio de um mail). Veja um exemplo (retirado da Se√ß√£o 8.6.2 do <a href="../cap8.html#mocks-vs-stubs">Cap√≠tulo 8</a> do livro)</p>
<pre><code>void testeEnvioDeMensagem {
  SomeObject obj = new SomeObject();    
  Mailer m = mock(Mailer.class);
  obj.someBusinessLogic(m);
  verify(m).send(anyString());
}</code></pre>
<p>No teste acima, n√£o testamos o efeito colateral (isto √©, se a mensagem chegou no destino), mas sim se o m√©todo <code>send</code>, respons√°vel por enviar a mensagem, foi chamado durante a execu√ß√£o de <code>someBusinessLogic</code>.</p>
<p>Antes de concluir, gostar√≠amos de mencionar que testes de intera√ß√£o, como o mostrado acima, s√£o mais fr√°geis, pois eles est√£o acoplados a detalhes da implementa√ß√£o interna do m√©todo que est√° sendo testado.</p>
<h3 class="unnumbered" id="como-testar-m√©todos-que-n√£o-t√™m-efeito-colateral">6. Como testar m√©todos que n√£o t√™m efeito colateral? <a href="#como-testar-m√©todos-que-n√£o-t√™m-efeito-colateral" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Normalmente, esses s√£o os m√©todos f√°ceis de serem testados: eles recebem alguns par√¢metros, processam eles e retornam um resultado, sem alterar absolutamente nada do ambiente de execu√ß√£o. Veja um exemplo:</p>
<pre><code>public void testeMetodoSemEfeitoColateral() {
  String s = &quot;smiles&quot;;
  assertTrue(s.endsWith(&quot;miles&quot;));
}
</code></pre>
<p>Testes como o acima, que apenas verificam o resultado do m√©todo chamado ‚Äî ou, no m√°ximo, o estado de alguma outra estrutura de dados do sistema ‚Äî s√£o chamados de <strong>testes de estado</strong>.</p>
<h3 class="unnumbered" id="quando-preciso-criar-um-mock-para-uma-depend√™ncia">7. Quando preciso criar um mock para uma depend√™ncia? <a href="#quando-preciso-criar-um-mock-para-uma-depend√™ncia" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Suponha que temos que testar um m√©todo <code>f</code> da seguinte classe:</p>
<pre><code>class A {
 
  private D d;   
 
  A(D d) {
    this.d = d;
  } 
 
  public int f(...) {  
    ...
  }
}</code></pre>
<p>A classe <code>A</code> possui uma depend√™ncia <code>d</code> para o tipo <code>D</code>. Quando precisamos criar um mock para essa depend√™ncia?</p>
<ul>
<li><p>Quando <code>D</code> √© um servi√ßo lento, como um banco de dados.</p></li>
<li><p>Quando n√£o √© trivial instanciar um objeto do tipo <code>D</code>. Por exemplo, a construtora de <code>D</code> pode exigir como par√¢metro um objeto do tipo <code>E</code>; por sua vez, a construtora de <code>E</code> pode exigir um objeto do tipo <code>F</code> e assim por diante.</p></li>
<li><p>Quando <code>D</code> √© um servi√ßo n√£o-determin√≠stico. Por exemplo, <code>D</code> √© um servi√ßo financeiro cujo resultado varia com a cota√ß√£o do d√≥lar.</p></li>
<li><p>Quando a execu√ß√£o de um m√©todo de <code>D</code> for importante para o teste, conforme vimos no teste comportamental da pergunta 4. Nesse teste, <code>D</code> √© o tipo <code>Mailer</code>e precisamos testar se a execu√ß√£o de <code>f</code> vai enviar um mail.</p></li>
</ul>
<h3 class="unnumbered" id="como-criar-um-mock-para-uma-depend√™ncia-privada">8. Como criar um mock para uma depend√™ncia privada? <a href="#como-criar-um-mock-para-uma-depend√™ncia-privada" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Se a depend√™ncia for configur√°vel por meio do construtor da classe ou de um m√©todo <code>set</code> n√£o existe problema.</p>
<p>Por√©m, se a depend√™ncia n√£o for configur√°vel de fora da classe, a√≠ sim temos um problema. Nesse caso, a √∫nica solu√ß√£o √© expor essa depend√™ncia de forma a permitir a sua configura√ß√£o pelo teste. Evidentemente, isso pode quebrar o encapsulamento da classe, mas n√£o existe outra solu√ß√£o.</p>
<h3 class="unnumbered" id="por-que-n√£o-usam-o-termo-dubl√™-de-testes-no-livro">9. Por que n√£o usam o termo dubl√™ de testes no livro? <a href="#por-que-n√£o-usam-o-termo-dubl√™-de-testes-no-livro" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Reconhecemos que <strong>dubl√™</strong> √© um termo usado por diversos autores, desde que foi descrito no livro do Gerard Meszaros (<em>xUnit Test Patterns</em>).</p>
<p>Por√©m, achamos que mock √© um termo mais comum, principalmente entre ferramentas de teste. Veja alguns exemplos:</p>
<ul>
<li><p><em>Jest uses a custom resolver for imports in your tests, making it simple to <strong>mock any object</strong> outside of your test‚Äôs scope.</em></p></li>
<li><p><em>Mockito is a <strong>mocking framework</strong> that tastes really good.</em></p></li>
<li><p><em>unittest.mock ‚Ä¶ allows you to replace parts of your system under test with <strong>mock objects</strong>.</em></p></li>
</ul>
<p>Ou seja, para ficarmos alinhados com a documenta√ß√£o dessas ferramentas, preferimos adotar o termo mock.</p>
<p>Al√©m disso, achamos que a diferen√ßa entre os v√°rios tipos de dubl√™s n√£o √© intuitiva, nem auto-explicativa. Ou seja, n√£o √© t√£o simples lembrar, no dia a dia, a caracter√≠stica distintiva de um spy, stub, dummy, fake, etc.</p>
<p>Por outro lado, √© importante ressaltar que acrescentamos, no livro, uma nota explicando o conceito de dubl√™s e seus diferentes tipos.</p>
<h3 class="unnumbered" id="em-qual-pacote-ou-m√≥dulo-ou-diret√≥rio-devo-colocar-os-testes">10. Em qual pacote (ou m√≥dulo, ou diret√≥rio) devo colocar os testes? <a href="#em-qual-pacote-ou-m√≥dulo-ou-diret√≥rio-devo-colocar-os-testes" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>Tipicamente, na maioria das linguagens, os testes ficam em um diret√≥rio separado, apenas com o c√≥digo de testes.</p>
<p>Veja o exemplo do sistema <code>google/guava</code>:</p>
<ul>
<li>As classes e pacotes do sistema ficam em <code>src/com/google/common</code>.</li>
<li>Os respectivos testes ficam em <code>test/com/google/common</code>.</li>
</ul>
<h3 class="unnumbered" id="o-que-√©-um-teste-de-fuma√ßa-smoke-test">11. O que √© um teste de fuma√ßa (smoke test)? <a href="#o-que-√©-um-teste-de-fuma√ßa-smoke-test" class="anchor-link" aria-hidden="true">üîó</a></h3>
<p>√â um teste de sistema, por√©m r√°pido e superficial. O objetivo √© garantir que n√£o existe um erro grave no funcionamento do sistema. Ou seja, se n√£o existe um <q>inc√™ndio</q> (ou problema) de grandes propor√ß√µes e que est√° gerando uma grande quantidade de <q>fuma√ßa</q>. Por exemplo, um teste de fuma√ßa pode verificar se algumas telas da aplica√ß√£o est√£o abrindo ou se determinadas APIs respondem a solicita√ß√µes b√°sicas. Mas, complementando, um teste de fuma√ßa √© um teste autom√°tico.</p>
<p>Veja a descri√ß√£o do teste de fuma√ßa de uma aplica√ß√£o:</p>
<blockquote>
<p>O nosso teste gera uma requisi√ß√£o HTTP para cada p√°gina da aplica√ß√£o e ent√£o testamos se o c√≥digo de resposta HTTP retornado est√° correto. Embora n√£o seja nada sofisticado, ele nos permite responder uma quest√£o essencial: a aplica√ß√£o est√° rodando?</p>
</blockquote>
<hr />
<p>Voltar para a lista de <a href="./artigos.html">artigos</a>.</p>
</div>
</div>
</div>

<footer>
Direitos autorais reservados. Vers√£o para uso pessoal.
Para reportar quaisquer erros, incluindo pequenos erros de ortografia, use este <a href="https://forms.gle/KbzvMx5RLnqPR7uq7">formul√°rio</a>.
</footer>
</body>
</html>
