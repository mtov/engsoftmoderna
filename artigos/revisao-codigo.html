<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Marco Tulio Valente" />
  <title>Revis√£o de C√≥digo: Uma Breve Introdu√ß√£o ‚Äì Engenharia de Software Moderna</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    q { quotes: "‚Äú" "‚Äù" "‚Äò" "‚Äô"; }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-8249107-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-8249107-3');
  </script>

  <script>
  var trackOutboundLink = function(url, action, category) {
      gtag('event', action, {
        'event_category': category,
        'event_label': url,
        'transport_type': 'beacon',
        'event_callback': function(){document.location = url;}
      });
  }
  </script>

  <link rel="shortcut icon" type="image/x-icon" href="https://engsoftmoderna.info/figs/favicon.ico">

  <!--
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css">
  --->

  <link rel="stylesheet" href="https://engsoftmoderna.info/helper/mini-default.min.css">

  <style>
  body {
    background-color: #FFFFFF;
    foreground-color: black;
  }
  </style>
</head>
<body>
<div class="container">
<div class="row cols-sm-12 col-md-8 col-lg-6">
<div class="col-md-offset-1 col-lg-offset-3">

<p>
<a href="https://engsoftmoderna.info"><img src="https://engsoftmoderna.info/figs/capa/foto-capitulos-html.jpg"></a>
</p>

<p>
<a href="https://engsoftmoderna.info">P√°gina principal do livro</a>
</p>

<p>Compre na

<a href="https://www.amazon.com.br/gp/product/6500019504"
      onclick="trackOutboundLink('https://www.amazon.com.br/gp/product/6500019504', 'amazon-caps', 'amazon-caps'); return false;">
      Amazon</a>, 

<a href="https://www.submarino.com.br/produto/1768283036/engenharia-de-software-moderna"
      onclick="trackOutboundLink('https://www.submarino.com.br/produto/1768283036/engenharia-de-software-moderna', 'submarino-caps', 'submarino-caps'); return false;">
      Submarino</a> ou 

<a href="https://produto.mercadolivre.com.br/MLB-1552071489-engenharia-de-software-moderna-_JM"
      onclick="trackOutboundLink('https://produto.mercadolivre.com.br/MLB-1552071489-engenharia-de-software-moderna-_JM', 'mercadolivre-caps', 'mercadolivre-caps'); return false;">
      MercadoLivre</a>.
</p>

<!---

<p>
<a href="https://twitter.com/engsoftmoderna?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-size="large" data-lang="pt" data-show-count="true">Follow @engsoftmoderna</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</p>


<p> <b> Novidade:</b> Estamos tamb√©m no 
<a href="https://twitter.com/engsoftmoderna"
  onclick="trackOutboundLink('https://twitter.com/engsoftmoderna', 'twitter', 'twitter'); return false;">
  Twitter</a>.
</p>

--->
<header id="title-block-header">
<h1 class="title">Engenharia de Software Moderna</h1>
<p class="author">Marco Tulio Valente</p>
</header>
<h1 class="unnumbered" id="revis√£o-de-c√≥digo-uma-breve-introdu√ß√£o">Revis√£o de C√≥digo: Uma Breve Introdu√ß√£o</h1>
<p>Artigo de autoria de <strong>Aline Torres</strong> e <strong>Marco Tulio Valente</strong>. Elaborado como parte da Monografia de Sistemas de Informa√ß√£o da primeira autora no DCC/UFMG.</p>
<h2 class="unnumbered" id="introdu√ß√£o">Introdu√ß√£o</h2>
<p>Revis√£o de c√≥digo √© uma das pr√°ticas mais importantes para garantir a sa√∫de a m√©dio e longo prazo da base de c√≥digo de um sistema. Ela √© hoje adotada por v√°rias empresas que desenvolvem software. Por exemplo, o Stack Overflow Survey de 2019 incluiu uma pergunta sobre o emprego da pr√°tica (veja figura). Dentre os mais de 70 mil desenvolvedores que responderam a essa pergunta, apenas 23% disseram que n√£o usavam revis√£o de c√≥digo (<a href="https://insights.stackoverflow.com/survey/2019#development-practices">link</a>).</p>
<p><img src="./figs/stackoverflow-survey-2019.jpg" style="width:50.0%" /></p>
<p>A ideia de revis√£o de c√≥digo √© simples: todo c√≥digo desenvolvido por um desenvolvedor tem que ser, em seguida, analisado por pelo menos um outro desenvolvedor, chamado de <strong>revisor</strong>. O revisor pode adicionar coment√°rios no c√≥digo sob revis√£o, procurando esclarecer d√∫vidas, sugerir melhorias, indicar bugs, etc.</p>
<p>Assim, estabelece-se um <q>di√°logo</q> ‚Äì na forma de uma troca de coment√°rios ‚Äî entre o <strong>autor</strong> do c√≥digo e o revisor. Como resultado, o autor pode modificar sua implementa√ß√£o para atender a algum coment√°rio do revisor que ele achou procedente. Ou ent√£o, ele pode replicar e justificar que o coment√°rio n√£o faz sentido‚Ä¶ Espera-se que ap√≥s esse <q>di√°logo</q> o c√≥digo seja aprovado pelo revisor e possa ser integrado no reposit√≥rio do projeto.</p>
<h2 class="unnumbered" id="pull-requests">Pull Requests</h2>
<p>Nesta se√ß√£o, vamos apresentar um breve tutorial sobre como revisar c√≥digo usando o recurso de <strong>Pull Requests (PR)</strong> do GitHub. Por meio desse recurso, desenvolvedores podem submeter c√≥digo para ser integrado no reposit√≥rio principal de um projeto. No entanto, antes da integra√ß√£o, o GitHub permite que outros desenvolvedores revisem esse c√≥digo.</p>
<p>Vamos dar um exemplo, baseado em uma classe <code>Estacionamento</code> que j√° usamos no Cap√≠tulo 5 do livro. Especificamente, vamos supor que uma autora criou um PR, no qual ela sugere adicionar essa classe no sistema. Ap√≥s isso, tem in√≠cio o processo de revis√£o, que voc√™ pode acompanhar tamb√©m pela pr√≥xima figura.</p>
<ul>
<li><p><strong>Coment√°rio 1</strong>: o revisor comenta que alguns atributos da classe <code>Estacionamento</code> poderiam ser privados. E sugere implementar um m√©todo <code>estaciona</code> para mediar o acesso a tais atributos</p></li>
<li><p><strong>Coment√°rio 2:</strong> a autora informa que concorda com a sugest√£o do revisor e, inclusive, j√° atualizou o seu c√≥digo com a modifica√ß√£o sugerida.</p></li>
<li><p><strong>Coment√°rio 3:</strong> O revisor aprova o PR. A mensagem LGTM significa <em>Looks Good to Me</em>. Ent√£o, o PR pode ser integrado no branch principal. Isso pode ser feito pela pr√≥pria autora, caso ela tenha permiss√£o de escrita no reposit√≥rio.</p></li>
</ul>
<p><img src="./figs/pull-request-screenshot.jpg" style="width:85.0%" /></p>
<h2 class="unnumbered" id="motiva√ß√µes-para-revis√£o-de-c√≥digo">Motiva√ß√µes para Revis√£o de C√≥digo</h2>
<p>Em 2013, Alberto Bacchelli e Christian Bird realizaram um estudo sobre revis√£o de c√≥digo com 873 desenvolvedores, testadores e gerentes da Microsoft (<a href="https://doi.org/10.1109/ICSE.2013.6606617">link</a>). A pr√≥xima figura ilustra as principais motiva√ß√µes para realiza√ß√£o de revis√£o de c√≥digo, na opini√£o dos funcion√°rios da Microsoft.</p>
<p><img src="./figs/code-review-paper-microsoft.jpg" style="width:62.0%" /></p>
<p>Conforme respondido por esses funcion√°rios, a principal motiva√ß√£o √© encontrar bugs no c√≥digo submetido. Por√©m, outros fatores tamb√©m s√£o importantes, como (1) melhorar o c√≥digo, (2) propor solu√ß√µes alternativas e (3) transferir conhecimento. Esse √∫ltimo benef√≠cio pode ocorrer nos dois sentidos, isto √©, o autor pode aprender com os coment√°rios do revisor e vice-versa. Por fim, a quarta motiva√ß√£o (<em>team awareness</em>) √© tamb√©m relacionada com o aspecto <q>social</q> de revis√µes de c√≥digo, pois elas evitam que surjam <q>ilhas de conhecimento</q> em um time. Em outras palavras, revis√£o de c√≥digo evita cen√°rios nos quais apenas alguns desenvolvedores dominam certas partes do c√≥digo.</p>
<h2 class="unnumbered" id="boas-pr√°ticas-para-revisores">Boas Pr√°ticas para Revisores</h2>
<p>Nesta se√ß√£o, vamos documentar e ilustrar algumas recomenda√ß√µes para revis√£o de c√≥digo.</p>
<p>Para chegar a essas recomenda√ß√µes, partimos do artigo <em>How to Give Respectful and Constructive Code Review Feedback</em>, de autoria de Michaela Greiler (<a href="https://www.michaelagreiler.com/respectful-constructive-code-review-feedback">link</a>). Em seguida, fizemos uma an√°lise de mais de 120 pull requests de projetos de c√≥digo aberto, hospedados no GitHub, buscando casos concretos de coment√°rios que seguem as recomenda√ß√µes que coletamos inicialmente. Ao todo, analisamos pelo menos 259 coment√°rios para selecionar os exemplos que iremos mostrar a seguir.</p>
<h3 class="unnumbered" id="recomenda√ß√µes-gen√©ricas">Recomenda√ß√µes Gen√©ricas</h3>
<p>Vamos come√ßar com algumas recomenda√ß√µes gen√©ricas:</p>
<ol type="1">
<li><p>Os revisores t√™m que lembrar que o objetivo da revis√£o √© <strong>detectar problemas claros</strong> no c√≥digo submetido. Por exemplo, √© natural que o revisor tivesse escolhido resolver o mesmo problema de um modo diferente‚Ä¶ Por√©m, a revis√£o n√£o √© para alternativas que n√£o tenham vantagens claras e inequ√≠vocas. Ou seja, um revisor somente deve propor uma alternativa se ela for, de fato, muito melhor!</p></li>
<li><p>Na linha da recomenda√ß√£o anterior, <strong>evite quest√µes subjetivas e sujeitas a estilos pessoais</strong>. Um exemplo s√£o nomes de vari√°veis. A n√£o ser que o nome de uma vari√°vel seja muito ruim, recomenda-se n√£o iniciar um debate sobre ele.</p></li>
<li><p>Em suas revis√µes, <strong>nunca use palavras ofensivas</strong>, sarc√°sticas ou mesmo ir√¥nicas. Em vez disso, seja sempre educado e profissional.</p></li>
<li><p>Sempre <strong>restrinja seus coment√°rios ao c√≥digo</strong> submetido e evite coment√°rios pessoais ou sobre outras quest√µes.</p></li>
</ol>
<h3 class="unnumbered" id="recomenda√ß√µes-espec√≠ficas">Recomenda√ß√µes Espec√≠ficas</h3>
<p>Seguem agora algumas recomenda√ß√µes espec√≠ficas:</p>
<ol start="5" type="1">
<li><p>Nos coment√°rios, <strong>procure fazer perguntas e n√£o julgamentos</strong>. Segue um exemplo de pergunta real feita por um revisor: <em>Is this actually used? Or is it something necessary to make the template magic work?</em></p></li>
<li><p>Se voc√™ tiver feito um coment√°rio errado ou sem sentido, <strong>reconhe√ßa o seu erro</strong> e agrade√ßa, como no seguinte exemplo: <em>Ah, I see the point. Thanks for your explanation.</em></p></li>
<li><p>Sempre que poss√≠vel, <strong>use emojis</strong>, pois eles deixam a linguagem mais coloquial e amig√°vel. Veja um exemplo real: <em>run yarn task. If the taskname is not conflicting with any native yarn command. It‚Äôll save time to everybody</em> üòÑ</p></li>
<li><p>Sempre que for interessante, <strong>referencie a documenta√ß√£o</strong> ‚Äì interna ou externa ao projeto ‚Äì para embasar seus coment√°rios, como neste exemplo: <em>+1 to specify volume id instead of volume name, because the id is UUID and safe to be specified. cinder delete allows id as https://docs.openstack.org/python-cinderclient/latest/cli/details.html#cinder-delete</em></p></li>
<li><p>N√£o deixe de <strong>elogiar o c√≥digo</strong> ou sua documenta√ß√£o, se achar que ele possui uma qualidade superior, como neste caso: <em>Thanks for the clear test instructions.</em></p></li>
<li><p>Se necess√°rio, <strong>use imagens e screenshots</strong> para explicar sua d√∫vida (veja tamb√©m na pr√≥xima figura): <em>The problem with this approach (which has been tried before) is that you can not trash an item when you have the filter set to all</em></p></li>
</ol>
<p><img src="./figs/code-review-screenshot.jpg" style="width:57.0%" /></p>
<ol start="11" type="1">
<li>Sempre que for razo√°vel, <strong>use o pronome <q>n√≥s</q></strong> ou a express√£o <q>a gente</q>, em vez de usar o pronome <q>voc√™</q>, pois assim voc√™ deixa claro que est√£o ‚Äî autor e revisor ‚Äì trabalhando juntos. Por exemplo, em vez de dizer, <em>ser√° que voc√™ n√£o poderia tornar esse atributo privado?</em>, voc√™ pode dizer: <em>ser√° que a gente n√£o poderia tornar esse atributo privado?</em></li>
</ol>
<h2 class="unnumbered" id="boas-pr√°ticas-para-autores">Boas Pr√°ticas para Autores</h2>
<p>Evidentemente, cabe aos autores tamb√©m ser profissionais e educados em suas respostas.</p>
<p>Outro ponto importante √© que os autores devem submeter pull requests pequenos, caso queiram obter uma resposta r√°pida e mais proveitosa dos revisores. Por exemplo, os autores do livro Software Engineering at Google, recomendam que <strong>um pull request deve ter no m√°ximo 200 linhas de c√≥digo</strong>.</p>
<h2 class="unnumbered" id="linters">Linters</h2>
<p>Antes de concluir, gostar√≠amos de comentar que diversos <q>problemas</q> tratados em uma revis√£o de c√≥digo podem ser automatizados por meio de ferramentas de an√°lise est√°tica. Por exemplo, quest√µes como conven√ß√µes de nomes de identificadores (camel case, snake case, etc), leiaute de c√≥digo e estilo de inten√ß√£o (tab ou espa√ßos, por exemplo) podem ser padronizadas por meio de linters. Com isso, evita-se que um revisor humano tenha que <q>perder tempo</q> com elas.</p>
<h2 class="unnumbered" id="exerc√≠cio">Exerc√≠cio</h2>
<p>Seja o seguinte c√≥digo, de uma classe Stack, quais coment√°rios voc√™ faria caso fosse respons√°vel pela sua revis√£o (sugest√£o: existem 4 quest√µes sobre esse c√≥digo que achamos que deveriam ser mencionadas em uma revis√£o de c√≥digo).</p>
<pre><code>import java.util.ArrayList;
import java.util.EmptyStackException;

public class Stack&lt;T&gt; {

  private ArrayList&lt;T&gt; elements = new ArrayList&lt;T&gt;();
  public int size = 0;

  public int size() {
    return size;
  }

  public boolean isEmpty() {
         return (size == 0);
  }

  public void empilha(T elem) {
    elements.add(elem);
    size++;
  }

  public T pop() throws EmptyStackException {
    if (isEmpty())
      throw new EmptyStackException();
    T elem = elements.get(size-1);
    size--;
    return elem;
  }
}</code></pre>
</div>
</div>
</div>

<footer>
Direitos autorais reservados. Vers√£o para uso pessoal.
Para reportar quaisquer erros, incluindo pequenos erros de ortografia, use este <a href="https://forms.gle/KbzvMx5RLnqPR7uq7">formul√°rio</a>.
</footer>
</body>
</html>
